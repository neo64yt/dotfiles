System.register(["./chunk-vendor.js","./chunk-frameworks.js"],(function(){"use strict";var t,e,o,r,s,n,a,i;return{setters:[function(a){t=a.r,e=a.a,o=a.o,r=a._,s=a.t,n=a.c},function(t){a=t.r,i=t.p}],execute:function(){t(".js-new-codespace-form",(async function(t,e){const o=t.closest("[data-replace-remote-form-target]"),r=o.querySelector(".js-new-codespace-submit-button");r instanceof HTMLInputElement&&(r.disabled=!0),t.classList.remove("is-error"),t.classList.add("is-loading");try{const t=await e.html();o.replaceWith(t.html)}catch(s){t.classList.remove("is-loading"),t.classList.add("is-error")}}));let c=null;function d(t){if(c=t,null!==t){document.querySelector(".js-codespace-loading-steps").setAttribute("data-current-state",c)}}e(".js-codespace-loading-steps",{constructor:HTMLElement,add:t=>{const e=t.getAttribute("data-current-state");e&&d(e)}}),e(".js-codespace-advance-state",{constructor:HTMLElement,add:t=>{const e=t.getAttribute("data-state");e&&d(e)}});let l=null;function u(t){const e=document.querySelector(".js-workbench-form-container form");e&&t?(!function(t,e){const o=t.querySelector(".js-cascade-token");o&&o.setAttribute("value",e)}(e,t),function(t,e){const o=t.querySelector(".js-partner-info");if(o){let t=o.getAttribute("value");t&&(t=t.replace("%CASCADE_TOKEN_PLACEHOLDER%",e),o.setAttribute("value",t))}}(e,t),a(e)):d("failed")}function h(t){const e=t.querySelectorAll(".js-toggle-hidden");for(const r of e)r.hidden=!r.hidden;const o=t.querySelectorAll(".js-toggle-disabled");for(const r of o)r.getAttribute("aria-disabled")?r.removeAttribute("aria-disabled"):r.setAttribute("aria-disabled","true")}async function f(t){const e=t.currentTarget,o=e.querySelector('[name="codespace[location]"]'),r=e.querySelector("button[type=submit]");r instanceof HTMLInputElement&&(r.disabled=!0);const s=e.getAttribute("data-codespace-locations-url");if(!s)return;const n=await async function(t){const e=await fetch(t,{headers:{"X-Requested-With":"XMLHttpRequest",Accept:"application/json"}});if(!e.ok){const t=new Error,o=e.statusText?" "+e.statusText:"";throw t.message=`HTTP ${e.status}${o}`,t}const o=await e.json();if(o)return o.current}(s);n&&(o.value=n)}e(".js-auto-submit-form",{constructor:HTMLFormElement,initialize:a}),e(".js-workbench-form-container",{constructor:HTMLElement,add:e=>{const o=document.querySelector(".js-fetch-cascade-token");var r;r=o,t(".js-fetch-cascade-token",(async function(t,e){try{const t=(await e.json()).json;l=t.token}catch(o){}})),a(r),function(t,e,o){if(document.querySelector(t)){const t=Date.now(),r=setInterval((()=>{const s=Date.now()-t;if(l||s>=o)return clearInterval(r),void e(l||void 0)}),50)}}(".js-workbench-form-container",u,1e4)}}),o("submit",".js-toggle-hidden-codespace-form",(function(t){h(t.currentTarget)})),o("submit","form.js-codespaces-delete-form",(async function(t){t.preventDefault();const e=t.currentTarget;try{const t=await fetch(e.action,{method:e.method,body:new FormData(e),headers:{Accept:"text/fragment+html","X-Requested-With":"XMLHttpRequest"}});if(t.ok){const o=i(document,await t.text());(function(t){return t.closest("[data-replace-remote-form-target]")})(e).replaceWith(o)}else{if(401!==t.status)throw new Error("Unexpected response: "+t.statusText);e.submit()}}finally{h(e)}})),o("submit",".js-prefetch-codespace-location",(async function(t){const e=t.currentTarget;t.preventDefault(),await f(t),e.submit()}));let p=class EditorSelectElement extends HTMLElement{async createCodespace(t){const e=t.currentTarget;t.preventDefault(),await f(t);let o=null;const r=new FormData(e);try{if(o=await fetch(e.action,{method:e.method,body:r,headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"}}),o.ok){const t=await o.json();"true"===r.get("open_in_vscode")&&this.showPostLaunch(),window.location.href=t.codespace_url}else if(401===o.status)e.submit();else if(422===o.status){const t=await o.json();this.showCreateError(t.error)}else this.showCreateError()}catch(s){return}finally{this.button.hidden=!0,this.disabledButton.hidden=!1}}showPostLaunch(){this.form.hidden=!0,this.postLaunch.hidden=!1,this.createError.hidden=!0,h(this.form)}showCreateError(t){this.form.hidden=!0,this.postLaunch.hidden=!0,this.createError.hidden=!1,t?(this.createErrorMessage.textContent=t,this.createErrorMessage.hidden=!1,this.defaultCreateErrorMessage.hidden=!0):(this.createErrorMessage.hidden=!0,this.defaultCreateErrorMessage.hidden=!1)}};r([s],p.prototype,"form",void 0),r([s],p.prototype,"postLaunch",void 0),r([s],p.prototype,"createError",void 0),r([s],p.prototype,"createErrorMessage",void 0),r([s],p.prototype,"defaultCreateErrorMessage",void 0),r([s],p.prototype,"button",void 0),r([s],p.prototype,"disabledButton",void 0),p=r([n],p);let m=class ExportBranchElement extends HTMLElement{constructor(){super(...arguments),this.abortPoll=null}connectedCallback(){this.abortPoll=new AbortController,this.loadingIndicator.hidden||this.startPoll()}disconnectedCallback(){var t;null===(t=this.abortPoll)||void 0===t||t.abort()}async exportBranch(t){t.preventDefault();(await fetch(this.form.action,{method:this.form.method,body:new FormData(this.form),headers:{Accept:"text/fragment+html","X-Requested-With":"XMLHttpRequest"}})).ok&&(this.form.hidden=!0,this.loadingIndicator.hidden=!1,this.startPoll())}async startPoll(){const t=this.getAttribute("data-exported-codespace-url")||"",e=await this.poll(t);if(e)if(e.ok)this.loadingIndicator.hidden=!0,this.viewBranchLink.hidden=!1;else{const t=this.getAttribute("data-export-error-redirect-url")||"";window.location.href=t}}async poll(t,e=1e3){var o,r;if(null===(o=this.abortPoll)||void 0===o?void 0:o.signal.aborted)return;const s=await fetch(t,{signal:null===(r=this.abortPoll)||void 0===r?void 0:r.signal});return 202===s.status?(await new Promise((t=>setTimeout(t,e))),this.poll(t,1.5*e)):s}};r([s],m.prototype,"form",void 0),r([s],m.prototype,"loadingIndicator",void 0),r([s],m.prototype,"viewBranchLink",void 0),m=r([n],m)}}}));
//# sourceMappingURL=codespaces-c882aa43.js.map
